<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/145.0.0.0 Safari/537.36" version="29.5.2">
  <diagram name="第 1 页" id="iJSPtvvun4tOZpGHkyr3">
    <mxGraphModel dx="1155" dy="740" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="client" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8EAF6;strokeColor=#7986CB;fontFamily=Helvetica;fontSize=12;arcSize=14;shadow=0;" value="&lt;b&gt;Operator&lt;/b&gt;&lt;br&gt;(Client / C++ Qt6)" vertex="1">
          <mxGeometry height="75" width="160" x="50" y="175" as="geometry" />
        </mxCell>
        <mxCell id="server_box" parent="1" style="swimlane;startSize=32;fillColor=#E3F2FD;strokeColor=#64B5F6;fontFamily=Helvetica;fontSize=13;rounded=1;arcSize=6;swimlaneLine=1;" value="AdaptixServer (Go)" vertex="1">
          <mxGeometry height="260" width="500" x="340" y="60" as="geometry" />
        </mxCell>
        <mxCell id="sqlite" parent="server_box" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=11;fillColor=#FFFFFF;strokeColor=#90A4AE;fontFamily=Helvetica;fontSize=11;" value="SQLite&lt;br&gt;数据库" vertex="1">
          <mxGeometry height="75" width="110" x="35" y="55" as="geometry" />
        </mxCell>
        <mxCell id="extender" parent="server_box" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#90A4AE;fontFamily=Helvetica;fontSize=11;" value="Extender 管理&lt;br&gt;&lt;font color=&quot;#888&quot; style=&quot;font-size:10px&quot;&gt;plugin.Open()&lt;/font&gt;" vertex="1">
          <mxGeometry height="65" width="170" x="250" y="60" as="geometry" />
        </mxCell>
        <mxCell id="ws_api" parent="server_box" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#90A4AE;fontFamily=Helvetica;fontSize=11;" value="WebSocket API&lt;br&gt;&lt;font color=&quot;#888&quot; style=&quot;font-size:10px&quot;&gt;:4321&lt;/font&gt;" vertex="1">
          <mxGeometry height="60" width="110" x="35" y="165" as="geometry" />
        </mxCell>
        <mxCell id="task_mgr" parent="server_box" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#90A4AE;fontFamily=Helvetica;fontSize=11;" value="任务调度 &amp; Agent 管理" vertex="1">
          <mxGeometry height="60" width="170" x="250" y="165" as="geometry" />
        </mxCell>
        <mxCell id="s_int1" edge="1" parent="server_box" source="extender" style="endArrow=none;dashed=1;strokeColor=#BDBDBD;" target="task_mgr">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ws_conn" edge="1" parent="1" source="client" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;fontFamily=Helvetica;fontSize=10;endArrow=block;endFill=1;startArrow=block;startFill=1;strokeColor=#5C6BC0;strokeWidth=2;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="ws_api" value="WebSocket (:4321)&#xa;TLS 双向认证">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="listener_box" parent="1" style="swimlane;startSize=28;fillColor=#E8F5E9;strokeColor=#81C784;fontFamily=Helvetica;fontSize=13;rounded=1;arcSize=6;" value="Listener 层" vertex="1">
          <mxGeometry height="120" width="500" x="340" y="400" as="geometry" />
        </mxCell>
        <mxCell id="lhttp" parent="listener_box" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#90A4AE;fontFamily=Helvetica;fontSize=11;" value="&lt;b&gt;HTTP&lt;/b&gt;&lt;br&gt;:443" vertex="1">
          <mxGeometry height="55" width="95" x="20" y="42" as="geometry" />
        </mxCell>
        <mxCell id="lsmb" parent="listener_box" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#90A4AE;fontFamily=Helvetica;fontSize=11;" value="SMB&lt;br&gt;named pipe" vertex="1">
          <mxGeometry height="55" width="95" x="135" y="42" as="geometry" />
        </mxCell>
        <mxCell id="ltcp" parent="listener_box" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#90A4AE;fontFamily=Helvetica;fontSize=11;" value="TCP&lt;br&gt;:port" vertex="1">
          <mxGeometry height="55" width="95" x="250" y="42" as="geometry" />
        </mxCell>
        <mxCell id="ldns" parent="listener_box" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#90A4AE;fontFamily=Helvetica;fontSize=11;" value="DNS&lt;br&gt;隧道" vertex="1">
          <mxGeometry height="55" width="95" x="365" y="42" as="geometry" />
        </mxCell>
        <mxCell id="plugin_edge" edge="1" parent="1" source="extender" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;fontFamily=Helvetica;fontSize=10;endArrow=block;endFill=1;dashed=1;dashPattern=8 4;strokeColor=#81C784;strokeWidth=1.5;" target="listener_box" value="加载 .so 插件">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="675" y="350" />
              <mxPoint x="590" y="350" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="agent_box" parent="1" style="swimlane;startSize=28;fillColor=#FFF8E1;strokeColor=#FFB74D;fontFamily=Helvetica;fontSize=13;rounded=1;arcSize=6;" value="Agent 植入体层" vertex="1">
          <mxGeometry height="120" width="500" x="340" y="600" as="geometry" />
        </mxCell>
        <mxCell id="beacon" parent="agent_box" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#90A4AE;fontFamily=Helvetica;fontSize=11;" value="&lt;b&gt;Beacon Agent&lt;/b&gt;&lt;br&gt;(C/C++)&lt;br&gt;&lt;font color=&quot;#888&quot; style=&quot;font-size:9px&quot;&gt;Windows x64 · RC4 · HTTP/SMB/TCP/DNS&lt;/font&gt;" vertex="1">
          <mxGeometry height="65" width="200" x="30" y="38" as="geometry" />
        </mxCell>
        <mxCell id="gopher" parent="agent_box" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#90A4AE;fontFamily=Helvetica;fontSize=11;" value="&lt;b&gt;Gopher Agent&lt;/b&gt;&lt;br&gt;(Go)&lt;br&gt;&lt;font color=&quot;#888&quot; style=&quot;font-size:9px&quot;&gt;跨平台 · mTLS · TCP 持久连接&lt;/font&gt;" vertex="1">
          <mxGeometry height="65" width="200" x="270" y="38" as="geometry" />
        </mxCell>
        <mxCell id="l2a" edge="1" parent="1" source="listener_box" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;fontFamily=Helvetica;fontSize=10;fontColor=#888;endArrow=block;endFill=1;startArrow=block;startFill=1;strokeColor=#FFB74D;strokeWidth=1.5;" target="agent_box" value="C2 通信信道">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
